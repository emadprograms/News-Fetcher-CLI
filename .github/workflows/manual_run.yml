name: ðŸ¦… Manual News Scan

on:
  workflow_dispatch:
    inputs:
      target_date:
        description: 'Optional: Date to scan (YYYY-MM-DD). If left blank, it automatically runs for the current "Trading Day" using our market-centric logic (e.g. tracking news across weekends/holidays until the market reopens). Only enter a date if you want to force a scan for a specific past day.'
        required: false
        default: ''

jobs:
  scan:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.12'
          cache: 'pip'

      - name: Install Dependencies
        run: |
          pip install -r requirements.txt

      - name: Setup Chrome for Selenium
        uses: browser-actions/setup-chrome@v1
        with:
          chrome-version: stable

      - name: Run Scan
        env:
          INFISICAL_CLIENT_ID: ${{ secrets.INFISICAL_CLIENT_ID }}
          INFISICAL_CLIENT_SECRET: ${{ secrets.INFISICAL_CLIENT_SECRET }}
          INFISICAL_PROJECT_ID: ${{ secrets.INFISICAL_PROJECT_ID }}
          TARGET_DATE: ${{ github.event.inputs.target_date }}
        run: |
          # The main.py is already configured to run with headless=True
          python3 main.py
